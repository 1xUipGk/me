<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3lismaeel - لوحة الإدارة</title>
    <link rel="icon" type="image/svg+xml" href="icon.svg">
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="dialog.css">
</head>
<body>
    <div class="dashboard">
        <div class="dashboard-header">
            <h1 class="dashboard-title">لوحة التحكم</h1>
            <div class="header-actions">
                <a href="/" class="visit-site-btn">
                    <i class="fas fa-external-link-alt"></i>
                    <span>زيارة الموقع</span>
                </a>
                <button onclick="logout()" class="logout-btn">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>تسجيل خروج</span>
                </button>
            </div>
        </div>

        <!-- إضافة بعد dashboard-header وقبل dashboard-grid -->
        <div class="stats-section">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-eye"></i>
                    </div>
                    <div class="stat-info">
                        <h3>المشاهدات</h3>
                        <div class="stat-value" id="viewsCount">0</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i>
                            <span id="viewsChange">0%</span>
                        </div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-info">
                        <h3>الزوار</h3>
                        <div class="stat-value" id="visitorsCount">0</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i>
                            <span id="visitorsChange">0%</span>
                        </div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-info">
                        <h3>متوسط وقت التصفح</h3>
                        <div class="stat-value" id="avgTimeCount">0:00</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i>
                            <span id="avgTimeChange">0%</span>
                        </div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="stat-info">
                        <h3>معدل التفاعل</h3>
                        <div class="stat-value" id="engagementCount">0%</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i>
                            <span id="engagementChange">0%</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="stats-charts">
                <div class="chart-card">
                    <h3>إحصائيات الزيارات</h3>
                    <canvas id="visitsChart"></canvas>
                </div>
                <div class="chart-card">
                    <h3>مصادر الزيارات</h3>
                    <canvas id="sourcesChart"></canvas>
                </div>
            </div>
        </div>

        <div class="dashboard-grid">
            <!-- نموذج الرفع -->
            <div class="upload-form">
                <h2>إضافة عمل جديد</h2>
                <form id="uploadForm">
                    <div class="form-group">
                        <label>القسم</label>
                        <select id="category" required>
                            <option value="social-media">سوشيال ميديا</option>
                            <option value="print">فلايرات وبروشورات</option>
                            <option value="roll-up">رول أب ولافتات</option>
                            <option value="menu">قوائم طعام</option>
                            <option value="business-cards">بطاقات شخصية</option>
                            <option value="book-covers">أغلفة كتب</option>
                            <option value="invitations">بطاقات دعوة</option>
                            <option value="certificates">شهادات تقديرية</option>
                            <option value="advertising">لوحات إعلانية</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>عنوان العمل</label>
                        <input type="text" id="title" required>
                    </div>
                    <div class="form-group">
                        <label>الصورة</label>
                        <input type="file" id="image" accept="image/*" required>
                        <div class="upload-progress">
                            <div class="progress-bar"></div>
                        </div>
                    </div>
                    <button type="submit" class="submit-btn">إضافة العمل</button>
                </form>
            </div>

            <!-- قائمة الأعمال -->
            <div class="works-section">
                <div class="filter-section">
                    <h2>تصفية الأعمال</h2>
                    <div class="filter-btns" id="filterBtns">
                        <button class="filter-btn active" data-category="all">الكل</button>
                        <button class="filter-btn" data-category="social-media">سوشيال ميديا</button>
                        <button class="filter-btn" data-category="print">فلايرات وبروشورات</button>
                        <button class="filter-btn" data-category="roll-up">رول أب ولافتات</button>
                        <button class="filter-btn" data-category="menu">قوائم طعام</button>
                        <button class="filter-btn" data-category="business-cards">بطاقات شخصية</button>
                        <button class="filter-btn" data-category="book-covers">أغلفة كتب</button>
                        <button class="filter-btn" data-category="invitations">بطاقات دعوة</button>
                        <button class="filter-btn" data-category="certificates">شهادات تقديرية</button>
                        <button class="filter-btn" data-category="advertising">لوحات إعلانية</button>
                    </div>
                </div>
                <div class="works-list" id="worksList">
                    <!-- سيتم إضافة الأعمال هنا ديناميكياً -->
                </div>
            </div>

            <!-- تحديث هيكل قسم التقييمات -->
            <div class="testimonials-section">
                <div class="testimonial-form-container">
                    <h2>إضافة تقييم جديد</h2>
                    <form id="testimonialForm" class="upload-form">
                        <div class="form-group">
                            <label>اسم العميل</label>
                            <input type="text" id="clientName" required placeholder="مثال: محمد العلي">
                        </div>
                        <div class="form-group">
                            <label>لمسمى الوظيفي</label>
                            <input type="text" id="clientTitle" required placeholder="مثال: صاحب مشروع">
                        </div>
                        <div class="form-group">
                            <label>صورة العميل (اختياري)</label>
                            <input type="file" id="clientImage" accept="image/*">
                            <div class="upload-progress">
                                <div class="progress-bar"></div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>التقييم</label>
                            <div class="rating-input">
                                <i class="far fa-star" data-rating="1"></i>
                                <i class="far fa-star" data-rating="2"></i>
                                <i class="far fa-star" data-rating="3"></i>
                                <i class="far fa-star" data-rating="4"></i>
                                <i class="far fa-star" data-rating="5"></i>
                            </div>
                            <input type="hidden" id="rating" value="5">
                        </div>
                        <div class="form-group">
                            <label>نص التقييم</label>
                            <textarea id="testimonialText" required rows="4" placeholder="اكتب رأي العميل هنا..."></textarea>
                        </div>
                        <button type="submit" class="submit-btn">إضافة تقييم</button>
                    </form>
                </div>

                <div class="testimonials-list-container">
                    <h2>التقييمات الحالية</h2>
                    <div id="testimonialsList">
                        <!-- سيتم إضافة التقييمات هنا ديناميكياً -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="message success-message" id="successMessage">
        <i class="fas fa-check-circle"></i>
        <span></span>
    </div>
    <div class="message error-message" id="errorMessage">
        <i class="fas fa-exclamation-circle"></i>
        <span></span>
    </div>

    <div class="dashboard-lightbox" id="dashboardLightbox">
        <div class="lightbox-content">
            <img src="" alt="" class="lightbox-image" id="lightboxImage">
            <div class="lightbox-info">
                <div class="lightbox-title" id="lightboxTitle"></div>
                <div class="lightbox-category" id="lightboxCategory">
                    <i class="fas fa-folder"></i>
                    <span></span>
                </div>
            </div>
            <button class="lightbox-close" onclick="closeLightbox()">
                <i class="fas fa-times"></i>
            </button>
            <button class="lightbox-nav lightbox-prev" onclick="navigateLightbox('prev')">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="lightbox-nav lightbox-next" onclick="navigateLightbox('next')">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>


    <div class="confirm-dialog" id="confirmDialog">
        <div class="confirm-content">
            <div class="confirm-icon">
                <i class="material-icons">warning</i>
            </div>
            <h3>تأكيد الحذف</h3>
            <p>هل أنت متأكد من حذف هذا العنصر؟ لا يمكن التراجع عن هذا الإجراء.</p>
            <div class="confirm-buttons">
                <button class="confirm-btn delete" id="confirmDelete">
                    <i class="material-icons">delete</i>
                    <span>حذف</span>
                </button>
                <button class="confirm-btn cancel" id="cancelDelete">
                    <i class="material-icons">close</i>
                    <span>إلغاء</span>
                </button>
            </div>
        </div>
    </div>

    <div class="edit-dialog" id="editDialog">
        <div class="edit-content">
            <div class="edit-header">
                <h3>تعديل العمل</h3>
                <button class="close-edit" id="closeEdit">
                    <i class="material-icons">close</i>
                </button>
            </div>
            <form id="editForm" class="edit-form">
                <div class="form-group">
                    <label>القسم</label>
                    <select id="editCategory" required>
                        <option value="social-media">سوشيال ميديا</option>
                        <option value="print">فلايرات وبروشورات</option>
                        <option value="roll-up">رول أب ولافتات</option>
                        <option value="menu">قوائم طعام</option>
                        <option value="business-cards">بطاقات شخصية</option>
                        <option value="book-covers">أغلفة كتب</option>
                        <option value="invitations">بطاقات دعوة</option>
                        <option value="certificates">شهادات تقديرية</option>
                        <option value="advertising">لوحات إعلانية</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>عنوان العمل</label>
                    <input type="text" id="editTitle" required>
                </div>
                <div class="form-group">
                    <label>تحديث الصورة (اختياري)</label>
                    <input type="file" id="editImage" accept="image/*">
                    <div class="current-image">
                        <img id="currentImage" src="" alt="الصورة الحالية">
                        <span>الصورة الحالية</span>
                    </div>
                    <div class="upload-progress">
                        <div class="progress-bar"></div>
                    </div>
                </div>
                <div class="edit-buttons">
                    <button type="submit" class="edit-submit">
                        <i class="material-icons">save</i>
                        <span>حفظ التغييرات</span>
                    </button>
                    <button type="button" class="edit-cancel" onclick="closeEditDialog()">
                        <i class="material-icons">close</i>
                        <span>إلغاء</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div class="edit-dialog" id="editTestimonialDialog">
        <div class="edit-content">
            <div class="edit-header">
                <h3>تعديل التقييم</h3>
                <button class="close-edit" id="closeEditTestimonial">
                    <i class="material-icons">close</i>
                </button>
            </div>
            <form id="editTestimonialForm" class="edit-form">
                <div class="form-group">
                    <label>اسم العميل</label>
                    <input type="text" id="editClientName" required>
                </div>
                <div class="form-group">
                    <label>المسمى الوظيفي</label>
                    <input type="text" id="editClientTitle" required>
                </div>
                <div class="form-group">
                    <label>تحديث الصورة (اختياري)</label>
                    <input type="file" id="editClientImage" accept="image/*">
                    <div class="current-image">
                        <img id="currentTestimonialImage" src="" alt="الصورة الحالية">
                        <span>الصورة الحالية</span>
                    </div>
                </div>
                <div class="form-group">
                    <label>التقييم</label>
                    <div class="rating-input" id="editRatingInput">
                        <i class="far fa-star" data-rating="1"></i>
                        <i class="far fa-star" data-rating="2"></i>
                        <i class="far fa-star" data-rating="3"></i>
                        <i class="far fa-star" data-rating="4"></i>
                        <i class="far fa-star" data-rating="5"></i>
                    </div>
                    <input type="hidden" id="editRating" value="5">
                </div>
                <div class="form-group">
                    <label>نص التقييم</label>
                    <textarea id="editTestimonialText" required rows="4"></textarea>
                </div>
                <div class="edit-buttons">
                    <button type="submit" class="edit-submit">
                        <i class="material-icons">save</i>
                        <span>حفظ التغييرات</span>
                    </button>
                    <button type="button" class="edit-cancel" onclick="closeEditTestimonialDialog()">
                        <i class="material-icons">close</i>
                        <span>إلغاء</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script type="module" src="dashboard.js"></script>
    <script src="protection.js"></script>
</body>
</html> 